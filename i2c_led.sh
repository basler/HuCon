#!/bin/bash -e
#
# Copyright (C) 2019 Basler AG
# All rights reserved.
#
# This software may be modified and distributed under the terms
# of the BSD license.  See the LICENSE file for details.

echo "$0: $1"

# All chanels off
i2cset -y 0 0x4A 0xFA 0x00
i2cset -y 0 0x4A 0xFB 0x00
i2cset -y 0 0x4A 0xFC 0x00
i2cset -y 0 0x4A 0xFD 0x00

# Init
i2cset -y 0 0x4A 0x01 0x04
i2cset -y 0 0x4A 0x00 0x01

# Set frquency to 50Hz
i2cset -y 0 0x4A 0x00 0x11
i2cset -y 0 0x4A 0xFE 0x79
i2cset -y 0 0x4A 0x00 0x01

# Reset
i2cset -y 0 0x4A 0x00 0x81

# Write the chanels for red
if [[ "$1" == "on" ]]; then
    i2cset -y 0 0x4A 0x10 0xFF
    i2cset -y 0 0x4A 0x24 0xFF
    i2cset -y 0 0x4A 0x38 0xFF
    i2cset -y 0 0x4A 0x44 0xFF
fi
